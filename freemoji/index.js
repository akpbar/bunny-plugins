(function(m,e,a,i,y,s,h,l){"use strict";const g=a.findByProps("canUseEmojisEverywhere");var v=[i.instead("canUseEmojisEverywhere",g,function(){return!0}),i.instead("canUseAnimatedEmojis",g,function(){return!0})];const{getCustomEmojiById:S}=a.findByStoreName("EmojiStore"),{getGuildId:E}=a.findByStoreName("SelectedGuildStore"),b=/<a?:(\w+):(\d+)>/i;function p(t,r){const n=t.matchAll(/<a?:(\w+):(\d+)>/gi);for(const o of n){const u=S(o[2]);if(u.guildId!=E()||u.animated){var c="webp";u.animated&&(c="gif"),e.storage.hyperlink===!0?e.storage.hyperlink_compat?t=t.replace(o[0],`[${o[1]}](https://cdn.discordapp.com/emojis/${o[2]}.${c}?size=${r})`):t=t.replace(o[0],`[:\u{E0032}${o[1]}:](https://cdn.discordapp.com/emojis/${o[2]}.${c}?size=${r})`):t=t.replace(o[0],`https://cdn.discordapp.com/emojis/${o[2]}.${c}?size=${r}&quality=lossless&name=${o[1]}`)}}return{newContent:t.trim()}}function j(t){if(!t.content.match(b)||!e.storage.forceMoji&&e.storage.haveNitro)return;const{newContent:r}=p(t.content,e.storage.emojiSize);t.content=r,t.invalidEmojis=[]}const R=a.findByProps("sendMessage","receiveMessage"),$=a.findByProps("uploadLocalFiles");var k=[i.before("sendMessage",R,function(t){return j(t[1])}),i.before("uploadLocalFiles",$,function(t){return j(t[0].parsedMessage)})];const{FormSection:d,FormRadioRow:z,FormSwitchRow:f}=s.Forms,F={Tiny:16,Small:32,Medium:48,Big:56,Large:64,Huge:96,Jumbo:128},w="https://cdn.discordapp.com/emojis/926602689213767680.webp";function B(){return h.useProxy(e.storage),React.createElement(y.ReactNative.ScrollView,{style:{flex:1},contentContainerStyle:{paddingBottom:38}},React.createElement(d,{title:"Settings",titleStyleType:"no_border"},React.createElement(f,{label:"Hyperlink emoji",subLabel:"Hyperlinks emoji link to be less distractive",leading:React.createElement(s.Forms.FormIcon,{source:l.getAssetIDByName("ic_link")}),value:e.storage.hyperlink,onValueChange:function(){e.storage.hyperlink=!e.storage.hyperlink},note:""}),React.createElement(f,{label:"Remove : from hyperlink",subLabel:"Increese hyperlink compatability",leading:React.createElement(s.Forms.FormIcon,{source:l.getAssetIDByName("ic_link")}),value:e.storage.hyperlink_compat,onValueChange:function(){e.storage.hyperlink_compat=!e.storage.hyperlink_compat},note:""}),React.createElement(f,{label:"Force Freemoji",subLabel:"Explicitly force Freemoji even if you have nitro (useful for testing)",leading:React.createElement(s.Forms.FormIcon,{source:l.getAssetIDByName("img_nitro_emojis")}),value:e.storage.forceMoji,onValueChange:function(){e.storage.forceMoji=!e.storage.forceMoji},note:""})),React.createElement(d,{title:"Emoji Size"},Object.entries(F).map(function(t){let[r,n]=t;return React.createElement(z,{label:r,subLabel:n,selected:e.storage.emojiSize===n,onPress:function(){e.storage.emojiSize=n}})})),React.createElement(d,{title:"Preview"},React.createElement(y.ReactNative.Image,{source:{uri:`${w}?size=${e.storage.emojiSize}`,width:e.storage.emojiSize,height:e.storage.emojiSize}})))}e.storage.emojiSize??=48,e.storage.hyperlink??=!0,e.storage.haveNitro??=a.findByStoreName("UserStore").getCurrentUser()?.premiumType!==null,e.storage.forceMoji??=!1,typeof e.storage.emojiSize=="string"&&(e.storage.emojiSize=parseInt(e.storage.emojiSize));const I=[...v,...k],M=function(){return I.forEach(function(t){return t()})};return m.onUnload=M,m.settings=B,m})({},vendetta.plugin,vendetta.metro,vendetta.patcher,vendetta.metro.common,vendetta.ui.components,vendetta.storage,vendetta.ui.assets);
